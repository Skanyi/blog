<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>What is Session Hijacking and How to Prevent It?</title>
  <meta property="og:title" content="What is Session Hijacking and How to Prevent It?" />
  <meta name="twitter:title" content="What is Session Hijacking and How to Prevent It?" />
  <meta name="description" content="Session Hijacking is when an attacker interacts with a server as another user. The attack take advantage of the active session between the victim and the server. What is a session? It is time period that the communication of two system is active.
There are two types of session hijacking,
a) Application Level - It is the most common now days and include, ID Sniffing, Session Fixation, Session Donation.">
  <meta property="og:description" content="Session Hijacking is when an attacker interacts with a server as another user. The attack take advantage of the active session between the victim and the server. What is a session? It is time period that the communication of two system is active.
There are two types of session hijacking,
a) Application Level - It is the most common now days and include, ID Sniffing, Session Fixation, Session Donation.">
  <meta name="twitter:description" content="Session Hijacking is when an attacker interacts with a server as another user. The attack take advantage of the active session between the victim and the server. What is a session? It is time period …">
  <meta name="author" content="Stephen Kanyi"/>
  <link href='https://Skanyi.github.io/blog/img/avatar-icon.png' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://Skanyi.github.io/blog/img/hugo.jpg" />
  <meta name="twitter:image" content="https://Skanyi.github.io/blog/img/hugo.jpg" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@StephenKanyiW" />
  <meta name="twitter:creator" content="@StephenKanyiW" />
  <meta property="og:url" content="https://Skanyi.github.io/blog/cyber-security/what-is-session-hijacking-and-how-to-prevent-it/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Kanyi Blog" />

  <meta name="generator" content="Hugo 0.30" />
  <link rel="canonical" href="https://Skanyi.github.io/blog/cyber-security/what-is-session-hijacking-and-how-to-prevent-it/" />
  <link rel="alternate" href="https://Skanyi.github.io/blog/index.xml" type="application/rss+xml" title="Kanyi Blog">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://Skanyi.github.io/blog/css/main.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://Skanyi.github.io/blog/css/pygment_highlights.css" />
  <link rel="stylesheet" href="https://Skanyi.github.io/blog/css/highlight.min.css" />


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://Skanyi.github.io/blog/">Kanyi Blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="DevOps" href="/blog/devops/">DevOps</a>
            </li>
          
        
          
            <li>
              <a title="Development" href="/blog/development/">Development</a>
            </li>
          
        
          
            <li>
              <a title="Security" href="/blog/cyber-security/">Security</a>
            </li>
          
        
          
            <li>
              <a title="About" href="/blog/page/about/">About</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Kanyi Blog" href="https://Skanyi.github.io/blog/">
            <img class="avatar-img" src="https://Skanyi.github.io/blog/img/hugo.jpg" alt="Kanyi Blog" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="cyber-security-heading">
              <h1>What is Session Hijacking and How to Prevent It?</h1>
                
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        

<p><strong>Session Hijacking</strong> is when an attacker interacts with a server as another user. The attack take advantage of the active session between the victim and the server. <strong>What is a session?</strong> It is time period that the communication of two system is active.</p>

<p>There are two types of session hijacking,</p>

<p>a) <strong>Application Level</strong> - It is the most common now days and include, ID Sniffing, Session Fixation, Session Donation.</p>

<p>b) <strong>Network Level</strong> - Due to advancement in this layer, session hijacking in network level is very low. It includes; blind hijacking, IP spoofing.</p>

<p><strong>Session Persistence</strong> is what makes session hijacking possible. When a user login to a server, they get a token that they will use to send subsequent requests to server until that token expires. If the attacker get hold of the token, they can access all the resources that the user was able to access. Persistence is either on the cookies or in the URL.
<strong>Session Persistence in Cookies</strong>
Cookies can keep Session ID that are persisted on each request.
<strong>Advantages</strong> Cookies are not logged in normal requests, session ID can be persisted even after closing the browser.
<strong>Disadvantages</strong> It is vulnerable to cross site scripting(XSS) and you can only have one session per browser.</p>

<p><strong>Session Persistence in URL</strong>
The session ID form part of the url. This means it is only persistence per tab and can still work if client doesn&rsquo;t accept cookies.
<strong>Disadvantages</strong> Session IDs are sent in referrer and they are also stored in the logs.</p>

<p><strong>How to Hijack Sessions in Web Applications(WA)</strong>
We take advantage on WA session persistence mechanism.</p>

<ol>
<li><p><strong>Hijacking Cookies with XSS</strong> XSS allows attackers to run malicious code on the website/client. <strong>How does it work?</strong>
An attacker craft a url that has a script that does anything that the attacker wants, in this case sending the cookie of the victim back to the attacker when the victim clicks on the link.
Sometimes cookies are exposed on logs depending on the framework used. You can also use google dorks to find vulnerable sites to XSS.
<code>inurl: “search.php?q=”</code></p>

<p><strong>URL based session IDS</strong> are exposed in different areas, in the log files as the url are always logged. When clicking on the outbound links, the session ID is sent on the referer.</p></li>

<li><p><strong>Session Sniffing</strong>  This is more like MITM attack, where the attacker is looking at the traffic going through the wire in open network(unencrypted connection(HTTP)) capturing a valid token/session ID. I have a detailed post on <a href="https://skanyi.github.io/blog/cyber-security/network-security-man-in-the-middle-attacks/">How to perform MITM attack.</a></p></li>

<li><p><strong>Session Fixation</strong> As the name suggest, this is when an attacker predetermine the session ID for the victim. If the session ID is persisted on the URL, an attacker can send a link that the user will then authenticate and if the session ID remain the same the attacker will also be authenticated. If the session is persisted in the cookie, an attacker can send a link that has a javascript code that set the session ID. Ensuring that the session ID change when the user logs in can help you avoid this kind of attjack.</p></li>

<li><p><strong>Session Donation</strong> Involves Social Engineering(SE) to make it possible. An attacker creates an account and send authenticated link to the victim. Convincing the victim to provide more information about their account but in reality it is not their account but attackers acccount. Users are used to be logged in different sites making it less suspicious when the user click link that they already authenticated.</p></li>

<li><p><strong>BruteForce Session IDs</strong> Attacker can check the session ID to see if it has a pattern and try to bruteforce authenticated sessions. If session ID are incremental for example, it is very easy to check for authenticated session.</p></li>
</ol>

<h2 id="tools-to-automate-session-hijacking-attacks">Tools to Automate Session Hijacking Attacks:</h2>

<pre><code>- ZAP - OWASP Zed Attack Proxy
- Burp Suite
- NetSparker
- Ettercap
- Bettercap
</code></pre>

<h2 id="mitigating-risks-of-session-hijacking">Mitigating Risks of Session Hijacking</h2>

<ol>
<li><p><strong>Strong Session IDs</strong> You don&rsquo;t have to reinvent the wheel by creating your own session ids. It is better to delegate session id creation to the framework you are using.</p></li>

<li><p><strong>Keep Session IDs out of URL</strong> This will ensure that the id are not logged or passed in the referer when clicking outbound links.</p></li>

<li><p><strong>Don&rsquo;t Reuse Session IDs for Authentication</strong> Session fixation can be mitigated by ensuring that the ID change when a user authenticate to the system.</p></li>

<li><p><strong>Flag Session ID Cookies as HTTP Only</strong> It makes the ID inaccessible via Javascript helping to mitigate XSS.</p></li>

<li><p><strong>Use TLS</strong> Using SSL is not secure anymore as it have known vulnerabilities that attackers can exploit. Using TLS ensures that referer header is not sent when clicking outbound links. DNS Spoofing and MITM Sniffing are also reduced if not stopped.</p></li>

<li><p><strong>Flag Session ID Cookie as Secure</strong> Ensure cookies are not observed by an attacker. Setting the secure flag ensures that he cookie is not transmitted over unencrypted channel.</p></li>

<li><p><strong>Expire Sessions</strong> Expiring sessions after a period of time is a good way to mitigate how long hijacked sessions are active. It help protects the users as they have to create new session to be able to access the server and the attacker will have to try to hijack the session again.</p></li>

<li><p><strong>Disable Sliding Session</strong> The expiration of the session is counted from the time of the last request and not when the session was created. For example, if a session expires after 30 minutes, and a user does not make any request until the 20 minute, the session will not expire for the next 30 minutes instead of 10. The problem here is that, if an attacker has hijacked the session, he/she just need to keep making request to ensure the session does not expire.</p></li>

<li><p><strong>Encourge Users to Log Out</strong> When user logout, the session is terminated and all active session that were using that session ID are terminated.</p></li>

<li><p><strong>Reauthenticate Before Key Actions</strong> When withdrwaing money from online Escrow, it is important to reauthenticate again to ensure that it is the legit user who is making the request. That is just an example of why you might need reaunthentication like CAPTCHA, Secret Question and so on depending on the resource being requested.</p></li>
</ol>

<h5 id="understanding-how-to-find-exploits-and-demonstarting-how-thay-can-be-exploited-is-an-amazing-combination-to-have-as-ethical-hacker-when-doing-penetration-testing">understanding how to find exploits and demonstarting how thay can be exploited is an amazing combination to have as ethical hacker when doing penetration testing.</h5>

      </article>

      <ul class="pager blog-pager">
        
          <li class="previous">
            <a href="https://Skanyi.github.io/blog/cyber-security/what-is-dos-how-to-perform-dos-how-to-defend-against-dos/" data-toggle="tooltip" data-placement="top" title="What Is DOS? How To Perform DOS? How To Defend Against DOS?">&larr; Previous Post</a>
          </li>
        
        
      </ul>

      
        
          <div class="disqus-comments">
            <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "kanyi" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          </div>
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:contactkanyi@gmail.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/Skanyi" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/StephenKanyiW" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="https://Skanyi.github.io/blog/index.xml" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              Stephen Kanyi
                      
          
          
          &nbsp;&bull;&nbsp;
          2018

          
            &nbsp;&bull;&nbsp;
            <a href="https://Skanyi.github.io/blog/">Kanyi Blog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.30</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://Skanyi.github.io/blog/js/main.js"></script>
<script src="https://Skanyi.github.io/blog/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin="anonymous"></script>
<script src="https://Skanyi.github.io/blog/js/load-photoswipe.js"></script>



  </body>
</html>

